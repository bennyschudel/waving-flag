{"version":3,"sources":["m4.js","main.vert","noise.vert","noise.frag","main.js","index.js"],"names":["m4","create","perspective","fieldOfViewInRadians","aspect","near","far","f","Math","tan","PI","rangeInv","projection","width","height","depth","transpose","out","a","a01","a02","a03","a12","a13","a23","invert","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","multiply","b","b12","b13","b20","b21","b22","b23","b30","b31","b32","b33","translation","tx","ty","tz","xRotation","angleInRadians","c","cos","s","sin","yRotation","zRotation","scaling","sx","sy","sz","translate","m","xRotate","yRotate","zRotate","scale","inverse","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","d","cross","subtractVectors","normalize","v","length","sqrt","lookAt","cameraPosition","target","up","zAxis","xAxis","yAxis","transformVector","dst","i","j","module","exports","WavingFlag","getConfig","obj","dpr","window","devicePixelRatio","getProperties","cameraPitch","cameraYaw","cameraDist","scaleZ","translateZ","meshRows","meshColumns","framesToFade","lineSpacing","lineWidth","waveSpeed","waveSpeedD","waveSpeedMinI","waveSpeedMaxI","waveHeight","waveHeightD","waveHeightMinI","waveHeightMaxI","parentEl","config","properties","document","querySelector","canvas","createElement","style","round","appendChild","gl","getContext","antialias","console","error","pointerOn","projectionMatrix","viewMatrix","yaw","pitch","pointerPosition","x","y","z","max","min","setupCamera","fieldOfView","clientWidth","clientHeight","cameraTarget","dist","cameraMatrix","vertices","uv","elementCount","push","indices","toFloatStr","value","str","String","includes","fragmentSource","compileShader","shaderSource","shaderType","shader","createShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getAttribLocation","program","name","attributeLocation","getUniformLocation","uniformLocation","mix","pointerMove","evt","clientX","clientY","TouchEvent","changedTouches","pageX","pageY","rect","getBoundingClientRect","left","top","pointerLeave","pointerEnter","toggleListeners","remove","fn","bind","passive","bindListeners","unbindListeners","handles","noiseVertexShader","noiseVertexSource","VERTEX_SHADER","noiseFragmentShader","noiseFragmentSource","FRAGMENT_SHADER","vertexShader","vertexSource","fragmentShader","noiseProgram","createProgram","attachShader","linkProgram","useProgram","quadVertices","Float32Array","noiseVertexDataBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","noisePosition","vertexAttribPointer","FLOAT","enableVertexAttribArray","noiseScale","noiseResolution","noiseTextureSize","framebuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","perlinTexture","createAndSetupTexture","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","texImage2D","RGBA","UNSIGNED_BYTE","framebufferTexture2D","COLOR_ATTACHMENT0","uniform1f","uniform2f","viewport","clearColor","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLE_STRIP","vertexDataBuffer","position","uvBuffer","indexBuffer","modelMatrix","ELEMENT_ARRAY_BUFFER","Uint16Array","time","noiseTexture","activeTexture","TEXTURE0","uniform1i","uniformMatrix4fv","thisFrame","frame","lastFrame","Date","now","draw","enable","DEPTH_TEST","drawElements","TRIANGLES","UNSIGNED_SHORT","toggleInteraction","on","destroy","desktopViz","mobileViz","onAnimationFrame","requestAnimationFrame"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["var m4 = {\n  create: function () {\n    return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n  },\n\n  perspective: function (fieldOfViewInRadians, aspect, near, far) {\n    var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);\n    var rangeInv = 1.0 / (near - far);\n\n    return [\n      f / aspect,\n      0,\n      0,\n      0,\n      0,\n      f,\n      0,\n      0,\n      0,\n      0,\n      (near + far) * rangeInv,\n      -1,\n      0,\n      0,\n      near * far * rangeInv * 2,\n      0,\n    ];\n  },\n\n  projection: function (width, height, depth) {\n    // Note: This matrix flips the Y axis so 0 is at the top.\n    return [\n      2 / width,\n      0,\n      0,\n      0,\n      0,\n      -2 / height,\n      0,\n      0,\n      0,\n      0,\n      2 / depth,\n      0,\n      -1,\n      1,\n      0,\n      1,\n    ];\n  },\n\n  transpose: function (out, a) {\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\n    if (out === a) {\n      var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n      var a12 = a[6],\n        a13 = a[7];\n      var a23 = a[11];\n\n      out[1] = a[4];\n      out[2] = a[8];\n      out[3] = a[12];\n      out[4] = a01;\n      out[6] = a[9];\n      out[7] = a[13];\n      out[8] = a02;\n      out[9] = a12;\n      out[11] = a[14];\n      out[12] = a03;\n      out[13] = a13;\n      out[14] = a23;\n    } else {\n      out[0] = a[0];\n      out[1] = a[4];\n      out[2] = a[8];\n      out[3] = a[12];\n      out[4] = a[1];\n      out[5] = a[5];\n      out[6] = a[9];\n      out[7] = a[13];\n      out[8] = a[2];\n      out[9] = a[6];\n      out[10] = a[10];\n      out[11] = a[14];\n      out[12] = a[3];\n      out[13] = a[7];\n      out[14] = a[11];\n      out[15] = a[15];\n    }\n\n    return out;\n  },\n  /**\n   * Inverts a mat4\n   *\n   * @param {mat4} out the receiving matrix\n   * @param {mat4} a the source matrix\n   * @returns {mat4} out\n   */\n  invert: function (out, a) {\n    var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n    var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n    var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n\n    var b00 = a00 * a11 - a01 * a10;\n    var b01 = a00 * a12 - a02 * a10;\n    var b02 = a00 * a13 - a03 * a10;\n    var b03 = a01 * a12 - a02 * a11;\n    var b04 = a01 * a13 - a03 * a11;\n    var b05 = a02 * a13 - a03 * a12;\n    var b06 = a20 * a31 - a21 * a30;\n    var b07 = a20 * a32 - a22 * a30;\n    var b08 = a20 * a33 - a23 * a30;\n    var b09 = a21 * a32 - a22 * a31;\n    var b10 = a21 * a33 - a23 * a31;\n    var b11 = a22 * a33 - a23 * a32;\n\n    // Calculate the determinant\n    var det =\n      b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n  },\n\n  multiply: function (a, b) {\n    var a00 = a[0 * 4 + 0];\n    var a01 = a[0 * 4 + 1];\n    var a02 = a[0 * 4 + 2];\n    var a03 = a[0 * 4 + 3];\n    var a10 = a[1 * 4 + 0];\n    var a11 = a[1 * 4 + 1];\n    var a12 = a[1 * 4 + 2];\n    var a13 = a[1 * 4 + 3];\n    var a20 = a[2 * 4 + 0];\n    var a21 = a[2 * 4 + 1];\n    var a22 = a[2 * 4 + 2];\n    var a23 = a[2 * 4 + 3];\n    var a30 = a[3 * 4 + 0];\n    var a31 = a[3 * 4 + 1];\n    var a32 = a[3 * 4 + 2];\n    var a33 = a[3 * 4 + 3];\n    var b00 = b[0 * 4 + 0];\n    var b01 = b[0 * 4 + 1];\n    var b02 = b[0 * 4 + 2];\n    var b03 = b[0 * 4 + 3];\n    var b10 = b[1 * 4 + 0];\n    var b11 = b[1 * 4 + 1];\n    var b12 = b[1 * 4 + 2];\n    var b13 = b[1 * 4 + 3];\n    var b20 = b[2 * 4 + 0];\n    var b21 = b[2 * 4 + 1];\n    var b22 = b[2 * 4 + 2];\n    var b23 = b[2 * 4 + 3];\n    var b30 = b[3 * 4 + 0];\n    var b31 = b[3 * 4 + 1];\n    var b32 = b[3 * 4 + 2];\n    var b33 = b[3 * 4 + 3];\n    return [\n      b00 * a00 + b01 * a10 + b02 * a20 + b03 * a30,\n      b00 * a01 + b01 * a11 + b02 * a21 + b03 * a31,\n      b00 * a02 + b01 * a12 + b02 * a22 + b03 * a32,\n      b00 * a03 + b01 * a13 + b02 * a23 + b03 * a33,\n      b10 * a00 + b11 * a10 + b12 * a20 + b13 * a30,\n      b10 * a01 + b11 * a11 + b12 * a21 + b13 * a31,\n      b10 * a02 + b11 * a12 + b12 * a22 + b13 * a32,\n      b10 * a03 + b11 * a13 + b12 * a23 + b13 * a33,\n      b20 * a00 + b21 * a10 + b22 * a20 + b23 * a30,\n      b20 * a01 + b21 * a11 + b22 * a21 + b23 * a31,\n      b20 * a02 + b21 * a12 + b22 * a22 + b23 * a32,\n      b20 * a03 + b21 * a13 + b22 * a23 + b23 * a33,\n      b30 * a00 + b31 * a10 + b32 * a20 + b33 * a30,\n      b30 * a01 + b31 * a11 + b32 * a21 + b33 * a31,\n      b30 * a02 + b31 * a12 + b32 * a22 + b33 * a32,\n      b30 * a03 + b31 * a13 + b32 * a23 + b33 * a33,\n    ];\n  },\n\n  translation: function (tx, ty, tz) {\n    return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tx, ty, tz, 1];\n  },\n\n  xRotation: function (angleInRadians) {\n    var c = Math.cos(angleInRadians);\n    var s = Math.sin(angleInRadians);\n\n    return [1, 0, 0, 0, 0, c, s, 0, 0, -s, c, 0, 0, 0, 0, 1];\n  },\n\n  yRotation: function (angleInRadians) {\n    var c = Math.cos(angleInRadians);\n    var s = Math.sin(angleInRadians);\n\n    return [c, 0, -s, 0, 0, 1, 0, 0, s, 0, c, 0, 0, 0, 0, 1];\n  },\n\n  zRotation: function (angleInRadians) {\n    var c = Math.cos(angleInRadians);\n    var s = Math.sin(angleInRadians);\n\n    return [c, s, 0, 0, -s, c, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n  },\n\n  scaling: function (sx, sy, sz) {\n    return [sx, 0, 0, 0, 0, sy, 0, 0, 0, 0, sz, 0, 0, 0, 0, 1];\n  },\n\n  translate: function (m, tx, ty, tz) {\n    return m4.multiply(m, m4.translation(tx, ty, tz));\n  },\n\n  xRotate: function (m, angleInRadians) {\n    return m4.multiply(m, m4.xRotation(angleInRadians));\n  },\n\n  yRotate: function (m, angleInRadians) {\n    return m4.multiply(m, m4.yRotation(angleInRadians));\n  },\n\n  zRotate: function (m, angleInRadians) {\n    return m4.multiply(m, m4.zRotation(angleInRadians));\n  },\n\n  scale: function (m, sx, sy, sz) {\n    return m4.multiply(m, m4.scaling(sx, sy, sz));\n  },\n\n  inverse: function (m) {\n    var m00 = m[0 * 4 + 0];\n    var m01 = m[0 * 4 + 1];\n    var m02 = m[0 * 4 + 2];\n    var m03 = m[0 * 4 + 3];\n    var m10 = m[1 * 4 + 0];\n    var m11 = m[1 * 4 + 1];\n    var m12 = m[1 * 4 + 2];\n    var m13 = m[1 * 4 + 3];\n    var m20 = m[2 * 4 + 0];\n    var m21 = m[2 * 4 + 1];\n    var m22 = m[2 * 4 + 2];\n    var m23 = m[2 * 4 + 3];\n    var m30 = m[3 * 4 + 0];\n    var m31 = m[3 * 4 + 1];\n    var m32 = m[3 * 4 + 2];\n    var m33 = m[3 * 4 + 3];\n    var tmp_0 = m22 * m33;\n    var tmp_1 = m32 * m23;\n    var tmp_2 = m12 * m33;\n    var tmp_3 = m32 * m13;\n    var tmp_4 = m12 * m23;\n    var tmp_5 = m22 * m13;\n    var tmp_6 = m02 * m33;\n    var tmp_7 = m32 * m03;\n    var tmp_8 = m02 * m23;\n    var tmp_9 = m22 * m03;\n    var tmp_10 = m02 * m13;\n    var tmp_11 = m12 * m03;\n    var tmp_12 = m20 * m31;\n    var tmp_13 = m30 * m21;\n    var tmp_14 = m10 * m31;\n    var tmp_15 = m30 * m11;\n    var tmp_16 = m10 * m21;\n    var tmp_17 = m20 * m11;\n    var tmp_18 = m00 * m31;\n    var tmp_19 = m30 * m01;\n    var tmp_20 = m00 * m21;\n    var tmp_21 = m20 * m01;\n    var tmp_22 = m00 * m11;\n    var tmp_23 = m10 * m01;\n\n    var t0 =\n      tmp_0 * m11 +\n      tmp_3 * m21 +\n      tmp_4 * m31 -\n      (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\n    var t1 =\n      tmp_1 * m01 +\n      tmp_6 * m21 +\n      tmp_9 * m31 -\n      (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\n    var t2 =\n      tmp_2 * m01 +\n      tmp_7 * m11 +\n      tmp_10 * m31 -\n      (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\n    var t3 =\n      tmp_5 * m01 +\n      tmp_8 * m11 +\n      tmp_11 * m21 -\n      (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\n\n    var d = 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\n\n    return [\n      d * t0,\n      d * t1,\n      d * t2,\n      d * t3,\n      d *\n        (tmp_1 * m10 +\n          tmp_2 * m20 +\n          tmp_5 * m30 -\n          (tmp_0 * m10 + tmp_3 * m20 + tmp_4 * m30)),\n      d *\n        (tmp_0 * m00 +\n          tmp_7 * m20 +\n          tmp_8 * m30 -\n          (tmp_1 * m00 + tmp_6 * m20 + tmp_9 * m30)),\n      d *\n        (tmp_3 * m00 +\n          tmp_6 * m10 +\n          tmp_11 * m30 -\n          (tmp_2 * m00 + tmp_7 * m10 + tmp_10 * m30)),\n      d *\n        (tmp_4 * m00 +\n          tmp_9 * m10 +\n          tmp_10 * m20 -\n          (tmp_5 * m00 + tmp_8 * m10 + tmp_11 * m20)),\n      d *\n        (tmp_12 * m13 +\n          tmp_15 * m23 +\n          tmp_16 * m33 -\n          (tmp_13 * m13 + tmp_14 * m23 + tmp_17 * m33)),\n      d *\n        (tmp_13 * m03 +\n          tmp_18 * m23 +\n          tmp_21 * m33 -\n          (tmp_12 * m03 + tmp_19 * m23 + tmp_20 * m33)),\n      d *\n        (tmp_14 * m03 +\n          tmp_19 * m13 +\n          tmp_22 * m33 -\n          (tmp_15 * m03 + tmp_18 * m13 + tmp_23 * m33)),\n      d *\n        (tmp_17 * m03 +\n          tmp_20 * m13 +\n          tmp_23 * m23 -\n          (tmp_16 * m03 + tmp_21 * m13 + tmp_22 * m23)),\n      d *\n        (tmp_14 * m22 +\n          tmp_17 * m32 +\n          tmp_13 * m12 -\n          (tmp_16 * m32 + tmp_12 * m12 + tmp_15 * m22)),\n      d *\n        (tmp_20 * m32 +\n          tmp_12 * m02 +\n          tmp_19 * m22 -\n          (tmp_18 * m22 + tmp_21 * m32 + tmp_13 * m02)),\n      d *\n        (tmp_18 * m12 +\n          tmp_23 * m32 +\n          tmp_15 * m02 -\n          (tmp_22 * m32 + tmp_14 * m02 + tmp_19 * m12)),\n      d *\n        (tmp_22 * m22 +\n          tmp_16 * m02 +\n          tmp_21 * m12 -\n          (tmp_20 * m12 + tmp_23 * m22 + tmp_17 * m02)),\n    ];\n  },\n\n  cross: function (a, b) {\n    return [\n      a[1] * b[2] - a[2] * b[1],\n      a[2] * b[0] - a[0] * b[2],\n      a[0] * b[1] - a[1] * b[0],\n    ];\n  },\n\n  subtractVectors: function (a, b) {\n    return [a[0] - b[0], a[1] - b[1], a[2] - b[2]];\n  },\n\n  normalize: function (v) {\n    var length = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\n    // make sure we don't divide by 0.\n    if (length > 0.00001) {\n      return [v[0] / length, v[1] / length, v[2] / length];\n    } else {\n      return [0, 0, 0];\n    }\n  },\n\n  lookAt: function (cameraPosition, target, up) {\n    var zAxis = m4.normalize(m4.subtractVectors(cameraPosition, target));\n    var xAxis = m4.normalize(m4.cross(up, zAxis));\n    var yAxis = m4.normalize(m4.cross(zAxis, xAxis));\n\n    return [\n      xAxis[0],\n      xAxis[1],\n      xAxis[2],\n      0,\n      yAxis[0],\n      yAxis[1],\n      yAxis[2],\n      0,\n      zAxis[0],\n      zAxis[1],\n      zAxis[2],\n      0,\n      cameraPosition[0],\n      cameraPosition[1],\n      cameraPosition[2],\n      1,\n    ];\n  },\n\n  transformVector: function (m, v) {\n    var dst = [];\n    for (var i = 0; i < 4; ++i) {\n      dst[i] = 0.0;\n      for (var j = 0; j < 4; ++j) {\n        dst[i] += v[j] * m[j * 4 + i];\n      }\n    }\n    return dst;\n  },\n};\n\nexport default m4;\n","module.exports=\"precision highp float;\\n#define GLSLIFY 1\\nattribute vec3 position;\\nattribute vec2 vertexCoordinate;\\n\\nvarying vec2 uv;\\n\\nuniform mat4 modelMatrix;\\nuniform mat4 viewMatrix;\\nuniform mat4 projectionMatrix;\\n\\nuniform sampler2D perlinNoiseTexture;\\n\\nuniform float time;\\nuniform float waveSpeed;\\nuniform float waveHeight;\\n\\nuniform float scale;\\nconst int limit = 3;\\n\\nconst float angle = 0.0;\\n\\nconst float s = sin(angle);\\nconst float c = cos(angle);\\nconst mat2 rotation = mat2(c, s, -s, c);\\n\\nfloat getPerlinNoise(vec2 p){\\n  return 2.0 * texture2D(perlinNoiseTexture, p).x - 1.0;\\n}\\n\\nfloat fbm(vec2 pos){\\n  float res = 0.0;\\n  float freq = 1.0;\\n  float amp = 1.0;\\n  float ampSum = 0.0;\\n  \\n  for(int i = 0; i < limit; i++){ \\n    float offset = time * float(limit-i);\\n    res += getPerlinNoise(freq*(pos+offset)) * amp;\\n    ampSum += amp;\\n\\n    freq *= 2.0;\\n    amp *= 0.5;\\n    \\n    pos *= rotation;\\n  }\\n  return res/ampSum;\\n}\\n\\nvoid main(){ \\n  float noiseH = waveHeight * fbm(scale * position.xz);\\n  vec3 offset = vec3(noiseH, 0.0, 0.0);\\n  float noiseV = waveHeight * fbm(scale * (position.xz + offset.xz));\\n  offset.y += noiseV;\\n\\n  vec4 pos = projectionMatrix * viewMatrix * modelMatrix * vec4(position + offset, 1.0);\\n  uv = vertexCoordinate;\\n  gl_Position = pos;\\n}\\n\";","module.exports=\"#define GLSLIFY 1\\nattribute vec2 position;\\n\\nvoid main() { \\n  gl_Position = vec4(position, 0.0, 1.0);\\n}\\n\";","module.exports=\"\\n// GLSL version of 2D periodic seamless perlin noise.\\n// https://github.com/g-truc/glm/blob/master/glm/gtc/noise.inl\\n\\nprecision highp float;\\n#define GLSLIFY 1\\nuniform vec2 resolution;\\nuniform float scale;\\n\\nvec4 taylorInvSqrt(vec4 r) {\\n  return 1.79284291400159 - 0.85373472095314 * r;\\n}\\n\\nvec4 mod289(vec4 x){\\n    return x-floor(x * (1.0 / 289.0)) * 289.0;\\n}\\n\\nvec4 permute(vec4 x){\\n    return mod289(((x * 34.0) + 1.0) * x);\\n}\\n\\nvec2 fade(vec2 t){\\n    return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);\\n}\\n\\nfloat perlin(vec2 Position, vec2 rep) {\\n  vec4 Pi = floor(vec4(Position.x, Position.y, Position.x, Position.y)) + vec4(0.0, 0.0, 1.0, 1.0);\\n  vec4 Pf = fract(vec4(Position.x, Position.y, Position.x, Position.y)) - vec4(0.0, 0.0, 1.0, 1.0);\\n  Pi = mod(Pi, vec4(rep.x, rep.y, rep.x, rep.y)); // To create noise with explicit period\\n  Pi = mod(Pi, vec4(289)); // To avoid truncation effects in permutation\\n  vec4 ix = vec4(Pi.x, Pi.z, Pi.x, Pi.z);\\n  vec4 iy = vec4(Pi.y, Pi.y, Pi.w, Pi.w);\\n  vec4 fx = vec4(Pf.x, Pf.z, Pf.x, Pf.z);\\n  vec4 fy = vec4(Pf.y, Pf.y, Pf.w, Pf.w);\\n\\n  vec4 i = permute(permute(ix) + iy);\\n\\n  vec4 gx = float(2) * fract(i / float(41)) - float(1);\\n  vec4 gy = abs(gx) - float(0.5);\\n  vec4 tx = floor(gx + float(0.5));\\n  gx = gx - tx;\\n\\n  vec2 g00 = vec2(gx.x, gy.x);\\n  vec2 g10 = vec2(gx.y, gy.y);\\n  vec2 g01 = vec2(gx.z, gy.z);\\n  vec2 g11 = vec2(gx.w, gy.w);\\n\\n  vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\\n  g00 *= norm.x;\\n  g01 *= norm.y;\\n  g10 *= norm.z;\\n  g11 *= norm.w;\\n\\n  float n00 = dot(g00, vec2(fx.x, fy.x));\\n  float n10 = dot(g10, vec2(fx.y, fy.y));\\n  float n01 = dot(g01, vec2(fx.z, fy.z));\\n  float n11 = dot(g11, vec2(fx.w, fy.w));\\n\\n  vec2 fade_xy = fade(vec2(Pf.x, Pf.y));\\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\\n  return float(2.3) * n_xy;\\n}\\n\\nvoid main() {\\n  vec2 uv = gl_FragCoord.xy / resolution;\\n  float noise = perlin(scale * uv, vec2(scale));\\n  gl_FragColor = vec4(vec3(0.5 + 0.5 * noise), 1.0);\\n}\\n\";","import m4 from \"./m4.js\";\n\nimport vertexSource from \"./main.vert\";\nimport noiseVertexSource from \"./noise.vert\";\nimport noiseFragmentSource from \"./noise.frag\";\n\nexport const getConfig = function (obj) {\n  return {\n    width: 1440,\n    height: 900,\n    dpr: window.devicePixelRatio,\n\n    ...obj,\n  };\n};\n\nexport const getProperties = function (obj) {\n  return {\n    cameraPitch: 0.16,\n    cameraYaw: 1.26,\n    cameraDist: 1.79,\n\n    scaleZ: 2.0,\n    translateZ: -0.09,\n\n    meshRows: 128,\n    meshColumns: 256,\n\n    framesToFade: 15.0,\n\n    lineSpacing: 200.0,\n    lineWidth: 55.0,\n\n    waveSpeed: 0.2,\n    waveSpeedD: 0.001,\n    waveSpeedMinI: 0.002,\n    waveSpeedMaxI: 0.003,\n\n    waveHeight: 0.3,\n    waveHeightD: 0.094,\n    waveHeightMinI: 0.1,\n    waveHeightMaxI: 0.2,\n\n    scale: 0.3,\n\n    ...obj,\n  };\n};\n\nfunction WavingFlag(parentEl, config, properties) {\n  config = getConfig(config);\n  properties = getProperties(properties);\n\n  const { width, height, dpr } = config;\n  const { meshRows, meshColumns, lineSpacing, lineWidth } = properties;\n\n  // Canvas\n  if (typeof parentEl === \"string\") {\n    parentEl = document.querySelector(parentEl);\n  }\n\n  const canvas = document.createElement('canvas');\n\n  canvas.style.width = '100%';\n  canvas.style.height = '100%';\n\n  canvas.width = Math.round(width * dpr);\n  canvas.height = Math.round(height * dpr);\n\n  parentEl.appendChild(canvas);\n\n  let gl = canvas.getContext(\"webgl\", { antialias: true });\n\n  if (!gl) {\n    console.error(\"Unable to initialize WebGL.\");\n  }\n\n  // Pointer\n  let pointerOn = false;\n  let pointerPosition = { x: 0.5, y: 0.5 };\n\n  // Camera\n  let cameraPosition = { x: 1, y: 0, z: 1 };\n\n  let projectionMatrix;\n  let viewMatrix;\n\n  function normalize(v) {\n    let length = Math.sqrt(v.x * v.x + v.y * v.y + v.z * v.z);\n\n    return { x: v.x / length, y: v.y / length, z: v.z / length };\n  }\n\n  function getCameraPosition() {\n    const { cameraDist: dist } = properties;\n\n    return [\n      dist * cameraPosition.x,\n      dist * cameraPosition.y,\n      dist * cameraPosition.z,\n    ];\n  }\n\n  function updateCameraPosition() {\n    const { cameraYaw: yaw, cameraPitch } = properties;\n\n    const pitch = (properties.cameraPitch = Math.max(\n      -Math.PI / 2.0,\n      Math.min(Math.PI / 2.0, cameraPitch)\n    ));\n\n    cameraPosition.x = Math.sin(yaw);\n    cameraPosition.z = Math.cos(yaw);\n    cameraPosition.y = -Math.sin(pitch);\n\n    cameraPosition = normalize(cameraPosition);\n  }\n\n  function setupCamera() {\n    const fieldOfView = (45 * Math.PI) / 180;\n    const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;\n    const zNear = 0.1;\n    const zFar = 100.0;\n\n    projectionMatrix = m4.perspective(fieldOfView, aspect, zNear, zFar);\n\n    const cameraTarget = [0, 0, 0];\n    const up = [0, 1, 0];\n\n    const cameraMatrix = m4.lookAt(getCameraPosition(), cameraTarget, up);\n\n    viewMatrix = m4.inverse(cameraMatrix);\n  }\n\n  updateCameraPosition();\n  setupCamera();\n\n  // Geometry\n  const vertices = [];\n  const uv = [];\n\n  const elementCount = 2 * 3 * (meshColumns - 1) * (meshRows - 1);\n\n  for (let j = 0; j < meshRows; j++) {\n    for (let i = 0; i < meshColumns; i++) {\n      vertices.push(i / meshColumns - 0.5, 0.0, j / meshRows - 0.5);\n      uv.push(i / meshColumns, j / meshRows);\n    }\n  }\n\n  let indices = [];\n  for (let y = 0; y < meshRows - 1; y++) {\n    for (let x = 0; x < meshColumns - 1; x++) {\n      indices.push(\n        x + y * meshColumns,\n        x + y * meshColumns + 1,\n        x + (1 + y) * meshColumns\n      );\n      indices.push(\n        x + y * meshColumns + 1,\n        x + (y + 1) * meshColumns + 1,\n        x + (1 + y) * meshColumns\n      );\n    }\n  }\n\n  // Model\n  function getModelMatrix() {\n    const { scaleZ, translateZ } = properties;\n\n    let modelMatrix = m4.create();\n\n    modelMatrix = m4.zRotate(modelMatrix, Math.PI / 2.0);\n    modelMatrix = m4.scale(modelMatrix, 1.0, 1.0, scaleZ);\n    modelMatrix = m4.translate(modelMatrix, 0.0, 0.0, translateZ);\n\n    return modelMatrix;\n  }\n\n  // Texture\n  function toFloatStr(value) {\n    let str = String(value);\n    if (!str.includes(\".\")) {\n      str += \".0\";\n    }\n\n    return str;\n  }\n\n  function createAndSetupTexture(gl) {\n    var texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n\n    // Set up texture so we can render any size\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n    return texture;\n  }\n\n  // Shaders\n  let fragmentSource = `\n    precision highp float;\n    uniform sampler2D perlinNoiseTexture;\n    const float lineSpacing = ${toFloatStr(lineSpacing)};\n    const float lineWidth = ${toFloatStr(lineWidth)};\n    varying vec2 uv;\n    \n    void main() {\n      float col = 0.5 + 0.5 * sin(uv.x * lineSpacing);\n      float alpha = pow(col, lineWidth);\n      gl_FragColor = vec4(vec3(0.5 * alpha), alpha);\n    }`;\n\n  function compileShader(shaderSource, shaderType) {\n    let shader = gl.createShader(shaderType);\n    gl.shaderSource(shader, shaderSource);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw `Shader compile failed with: ${gl.getShaderInfoLog(shader)}`;\n    }\n\n    return shader;\n  }\n\n  function getAttribLocation(program, name) {\n    let attributeLocation = gl.getAttribLocation(program, name);\n    if (attributeLocation === -1) {\n      throw `Cannot find attribute ${name}`;\n    }\n\n    return attributeLocation;\n  }\n\n  function getUniformLocation(program, name) {\n    let uniformLocation = gl.getUniformLocation(program, name);\n    if (uniformLocation === -1) {\n      throw `Cannot find uniform ${name}`;\n    }\n\n    return uniformLocation;\n  }\n\n  // Interaction\n  function mix(x, y, a) {\n    return x * (1.0 - a) + y * a;\n  }\n\n  function fadeIn(f) {\n    const {\n      waveSpeedD,\n      waveSpeedMinI,\n      waveSpeedMaxI,\n      waveHeightD,\n      waveHeightMinI,\n      waveHeightMaxI,\n    } = properties;\n\n    properties.waveSpeed = mix(\n      waveSpeedD,\n      mix(waveSpeedMinI, waveSpeedMaxI, pointerPosition.x),\n      f\n    );\n    properties.waveHeight = mix(\n      waveHeightD,\n      mix(waveHeightMinI, waveHeightMaxI, pointerPosition.y),\n      f\n    );\n  }\n\n  function pointerMove(evt) {\n    let x = evt.clientX;\n    let y = evt.clientY;\n\n    if (evt instanceof TouchEvent) {\n      x = evt.changedTouches[0].pageX;\n      y = evt.changedTouches[0].pageY;\n    }\n\n    pointerOn = true;\n\n    const rect = canvas.getBoundingClientRect();\n\n    pointerPosition.x = (x - rect.left) / rect.width;\n    pointerPosition.y = (y - rect.top) / rect.height;\n  }\n\n  function pointerLeave() {\n    pointerOn = false;\n  }\n\n  function pointerEnter() {\n    pointerOn = true;\n  }\n\n  function toggleListeners(remove = false) {\n    const fn = canvas[remove ? \"removeEventListener\" : \"addEventListener\"].bind(\n      canvas\n    );\n\n    fn(\"mouseenter\", pointerEnter);\n    fn(\"mousemove\", pointerMove);\n    fn(\"mouseleave\", pointerLeave);\n\n    fn(\"touchstart\", pointerEnter, { passive: true });\n    fn(\"touchmove\", pointerMove, { passive: true });\n    fn(\"touchend\", pointerLeave, { passive: true });\n  }\n\n  const bindListeners = () => toggleListeners(false);\n  const unbindListeners = () => toggleListeners(true);\n\n  unbindListeners();\n  bindListeners();\n\n  // Shader\n  const handles = {};\n\n  const noiseVertexShader = compileShader(noiseVertexSource, gl.VERTEX_SHADER);\n  const noiseFragmentShader = compileShader(\n    noiseFragmentSource,\n    gl.FRAGMENT_SHADER\n  );\n\n  const vertexShader = compileShader(vertexSource, gl.VERTEX_SHADER);\n  const fragmentShader = compileShader(fragmentSource, gl.FRAGMENT_SHADER);\n\n  // Create shader programs\n  const noiseProgram = gl.createProgram();\n  gl.attachShader(noiseProgram, noiseVertexShader);\n  gl.attachShader(noiseProgram, noiseFragmentShader);\n  gl.linkProgram(noiseProgram);\n  gl.useProgram(noiseProgram);\n\n  // Set up rectangle covering entire canvas\n  const quadVertices = new Float32Array([\n    -1.0,\n    1.0, // top left\n    -1.0,\n    -1.0, // bottom left\n    1.0,\n    1.0, // top right\n    1.0,\n    -1.0, // bottom right\n  ]);\n\n  // Create vertex buffer\n  const noiseVertexDataBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, noiseVertexDataBuffer);\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array(quadVertices),\n    gl.STATIC_DRAW\n  );\n\n  handles.noisePosition = getAttribLocation(noiseProgram, \"position\");\n\n  // Layout of our data in the vertex buffer\n  gl.vertexAttribPointer(handles.noisePosition, 2, gl.FLOAT, false, 2 * 4, 0);\n  gl.enableVertexAttribArray(handles.noisePosition);\n\n  handles.noiseScale = gl.getUniformLocation(noiseProgram, \"scale\");\n  handles.noiseResolution = gl.getUniformLocation(noiseProgram, \"resolution\");\n\n  // Create and bind frame buffer\n  const noiseTextureSize = 256;\n  const framebuffer = gl.createFramebuffer();\n  framebuffer.width = noiseTextureSize;\n  framebuffer.height = noiseTextureSize;\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\n  // Create texture\n  const perlinTexture = createAndSetupTexture(gl);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.RGBA,\n    framebuffer.width,\n    framebuffer.height,\n    0,\n    gl.RGBA,\n    gl.UNSIGNED_BYTE,\n    null\n  );\n\n  // Attach texture to frame buffer\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER,\n    gl.COLOR_ATTACHMENT0,\n    gl.TEXTURE_2D,\n    perlinTexture,\n    0\n  );\n\n  // Draw noise to framebuffer\n  gl.useProgram(noiseProgram);\n\n  gl.uniform1f(handles.noiseScale, 8.0);\n  gl.uniform2f(handles.noiseResolution, noiseTextureSize, noiseTextureSize);\n\n  gl.viewport(0, 0, noiseTextureSize, noiseTextureSize);\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n  // fabric rendering\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  gl.useProgram(program);\n\n  const vertexDataBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexDataBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n\n  handles.position = getAttribLocation(program, \"position\");\n  gl.vertexAttribPointer(handles.position, 3, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(handles.position);\n\n  const uvBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, uvBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(uv), gl.STATIC_DRAW);\n\n  handles.uv = getAttribLocation(program, \"vertexCoordinate\");\n  gl.vertexAttribPointer(handles.uv, 2, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(handles.uv);\n\n  const indexBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);\n  gl.bufferData(\n    gl.ELEMENT_ARRAY_BUFFER,\n    new Uint16Array(indices),\n    gl.STATIC_DRAW\n  );\n\n  handles.time = getUniformLocation(program, \"time\");\n  handles.scale = getUniformLocation(program, \"scale\");\n  handles.projectionMatrix = getUniformLocation(program, \"projectionMatrix\");\n  handles.viewMatrix = getUniformLocation(program, \"viewMatrix\");\n  handles.modelMatrix = getUniformLocation(program, \"modelMatrix\");\n  handles.noiseTexture = getUniformLocation(program, \"noiseTexture\");\n  handles.waveHeight = getUniformLocation(program, \"waveHeight\");\n  handles.waveSpeed = getUniformLocation(program, \"waveSpeed\");\n\n  gl.useProgram(program);\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(gl.TEXTURE_2D, perlinTexture);\n  gl.uniform1i(handles.noiseTexture, 0);\n  gl.uniformMatrix4fv(handles.projectionMatrix, false, projectionMatrix);\n  gl.uniformMatrix4fv(handles.viewMatrix, false, viewMatrix);\n  gl.uniformMatrix4fv(handles.modelMatrix, false, getModelMatrix());\n\n  // Draw\n  let time = 0.0;\n  let frame = 0;\n  let lastFrame = Date.now();\n  let thisFrame;\n\n  function draw() {\n    const { framesToFade, waveSpeed, waveHeight, scale } = properties;\n\n    if (pointerOn) {\n      frame = Math.min(framesToFade, frame + 1.0);\n    } else {\n      frame = Math.max(0, frame - 1.0);\n    }\n\n    fadeIn(frame / framesToFade);\n\n    thisFrame = Date.now();\n    time += (25.0 * waveSpeed * (thisFrame - lastFrame)) / 1000;\n    lastFrame = thisFrame;\n\n    gl.useProgram(program);\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.uniform1i(handles.noiseTexture, 0);\n    gl.bindTexture(gl.TEXTURE_2D, perlinTexture);\n\n    gl.uniform1f(handles.time, time);\n    gl.uniform1f(handles.scale, scale);\n    gl.uniform1f(handles.waveSpeed, waveSpeed);\n    gl.uniform1f(handles.waveHeight, waveHeight);\n\n    gl.clearColor(0, 0, 0, 0);\n    gl.enable(gl.DEPTH_TEST);\n\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.drawElements(gl.TRIANGLES, elementCount, gl.UNSIGNED_SHORT, 0);\n  }\n\n  // public api\n\n  this.draw = draw;\n\n  this.toggleInteraction = (on) => (on ? bindListeners() : unbindListeners());\n\n  this.destroy = () => {\n    unbindListeners();\n  }\n}\n\nexport default WavingFlag;\n","import WavingFlag from \"./main.js\";\n\nconst desktopViz = new WavingFlag('#desktopViz', {\n  dpr: 2,\n}, {\n  lineSpacing: 200.0,\n  lineWidth: 55.0,\n\n  meshRows: 128,\n  meshColumns: 256,\n});\n\nconst mobileViz = new WavingFlag('#mobileViz', {\n  dpr: 1,\n}, {\n  lineSpacing: 100.0,\n  lineWidth: 25.0,\n\n  meshRows: 64,\n  meshColumns: 128,\n});\n\nfunction onAnimationFrame() {\n  desktopViz.draw();\n  // mobileViz.draw();\n\n  requestAnimationFrame(onAnimationFrame);\n}\n\nrequestAnimationFrame(onAnimationFrame);\n"]}